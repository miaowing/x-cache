/*!
 * X-cache v0.0.1
 * (c) 2016 Elwin-赵小峰
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(this,function(){"use strict";var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),i=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},n=function(){function i(){var t=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0];e(this,i),this.size=0,this.limit=t,this.head=this.tail=void 0,this._keymap=new Map}return t(i,[{key:"shift",value:function(){}},{key:"put",value:function(e,t){}},{key:"get",value:function(e,t){}},{key:"find",value:function(e){}},{key:"remove",value:function(e){}},{key:"removeAll",value:function(){}},{key:"forEach",value:function(e,t){}},{key:"getArray",value:function(e){}},{key:"getSize",value:function(){return this.size}}]),i}(),o=function(n){function o(){var t=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0];return e(this,o),r(this,Object.getPrototypeOf(o).call(this,t))}return i(o,n),t(o,[{key:"shift",value:function(){var e=this.head;return e&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,e.newer=e.older=void 0,this._keymap.delete(e.key),this.size--),e}},{key:"put",value:function(e,t){var i=this.get(e,!0);return void 0===i?(i={key:e,value:t},this._keymap.set(e,i),this.size==this.limit&&this.shift(),this.tail?(this.tail.newer=i,i.older=this.tail):this.head=i,this.tail=i,this.size++):i.value=t,i}},{key:"get",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=this._keymap.get(e);if(void 0!==i)return i===this.tail?t?i:i.value:(i.newer&&(i.head&&(this.head=i.newer),i.newer.older=i.older),i.older&&(i.older.newer=i.newer),i.newer=void 0,i.older=this.tail,this.tail&&(this.tail.newer=i),this.tail=i,t?i:i.value)}},{key:"find",value:function(e){return!!this._keymap.get(e)}},{key:"remove",value:function(e){var t=this._keymap.get(e);return void 0!==t&&(delete this._keymap[t.key],this.size--,t.newer&&t.older?(t.older.newer=t.newer,t.newer.older=t.older):t.newer?(t.newer.older=void 0,this.head=t.newer):t.older?(t.older.newer=void 0,this.tail=t.older):this.head=this.tail=void 0,!0)}},{key:"removeAll",value:function(){this.head=this.tail=void 0,this.size=0,this._keymap=new Map}},{key:"forEach",value:function(e){for(var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=t?this.head:this.tail;i;)e(i.key,i.value,i),i=t?i.newer:i.older}},{key:"getArray",value:function(){for(var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=[],i=e?this.head:this.tail;i;)t.push({key:i.key,value:i.value}),i=e?i.newer:i.older;return t}}]),o}(n),a=function(n){function o(){var t=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0];return e(this,o),r(this,Object.getPrototypeOf(o).call(this,t))}return i(o,n),t(o,[{key:"shift",value:function(){var e=this.head;return e&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,e.newer=e.older=void 0,this._keymap.delete(e.key),this.size--),e}},{key:"put",value:function(e,t){var i=this.get(e,!0);return void 0!==i&&this.remove(e),i={key:e,value:t},this._keymap.set(e,i),this.size==this.limit&&this.shift(),this.tail?(this.tail.newer=i,i.older=this.tail):this.head=i,this.tail=i,this.size++,i}},{key:"get",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return t?this._keymap.get(e):(this._keymap.get(e)||{}).value}},{key:"find",value:function(e){return!!this._keymap.get(e)}},{key:"remove",value:function(e){var t=this._keymap.get(e);return void 0!==t&&(delete this._keymap[t.key],this.size--,t.newer&&t.older?(t.older.newer=t.newer,t.newer.older=t.older):t.newer?(t.newer.older=void 0,this.head=t.newer):t.older?(t.older.newer=void 0,this.tail=t.older):this.head=this.tail=void 0,!0)}},{key:"removeAll",value:function(){this.head=this.tail=void 0,this.size=0,this._keymap=new Map}},{key:"forEach",value:function(e){for(var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=t?this.head:this.tail;i;)e(i.key,i.value,i),i=t?i.newer:i.older}},{key:"getArray",value:function(){for(var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=[],i=e?this.head:this.tail;i;)t.push({key:i.key,value:i.value}),i=e?i.newer:i.older;return t}}]),o}(n),h=function(n){function o(){var t=arguments.length<=0||void 0===arguments[0]?1e3:arguments[0];return e(this,o),r(this,Object.getPrototypeOf(o).call(this,t))}return i(o,n),t(o,[{key:"_remove",value:function(e){return e.newer&&e.older?(e.older.newer=e.newer,e.newer.older=e.older):e.newer?(this.head=e.newer,e.newer.older=void 0):e.older&&(this.tail=e.older,e.older.newer=void 0),e.newer=void 0,e.older=void 0,e}},{key:"_sort",value:function(e){var t=e.newer;for(t&&this._remove(e);t;){if(e.count<t.count){e.older=t.older,e.newer=t,t.older.newer=e,t.older=e;break}if(t===this.tail){e.older=this.tail,this.tail.newer=e,this.tail=e;break}t=t.newer}}},{key:"shift",value:function(){var e=this.head;return e&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,e.newer=e.older=void 0,this._keymap.delete(e.key),this.size--),e}},{key:"put",value:function(e,t){var i=this.get(e,!0);return void 0===i?(i={key:e,value:t,count:0},this._keymap.set(e,i),this.size==this.limit&&this.shift(),void 0===this.head?this.head=this.tail=i:(i.newer=this.head,this.head.older=i,this.head=i),this.size++):(this.size--,i.value=t),i}},{key:"get",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=this._keymap.get(e);if(void 0!==i)return i.count++,this._sort(i),t?i:i.value}},{key:"find",value:function(e){return!!this._keymap.get(e)}},{key:"remove",value:function(e){var t=this._keymap.get(e);return void 0!==t&&(delete this._keymap[t.key],this.size--,t.newer&&t.older?(t.older.newer=t.newer,t.newer.older=t.older):t.newer?(t.newer.older=void 0,this.head=t.newer):t.older?(t.older.newer=void 0,this.tail=t.older):this.head=this.tail=void 0,!0)}},{key:"removeAll",value:function(){this.head=this.tail=void 0,this.size=0,this._keymap=new Map}},{key:"forEach",value:function(e){for(var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=t?this.head:this.tail;i;)e(i.key,i.value,i),i=t?i.newer:i.older}},{key:"getArray",value:function(){for(var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=[],i=e?this.head:this.tail;i;)t.push({key:i.key,value:i.value}),i=e?i.newer:i.older;return t}}]),o}(n);exports.LruXCache=o,exports.FifoXCache=a,exports.LfuXCache=h,exports.XCache=function(e,t){switch(e=e||"lru",t=t||{},e){case"lru":return new o(t.limit);case"fifo":return new a(t.limit)}}});
//# sourceMappingURL=xcache.min.js.map